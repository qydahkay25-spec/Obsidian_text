# 水质COD多光谱融合检测技术研究

## 一、研究核心背景与意义
- **核心问题**：工业发展导致水体有机物污染加剧，COD（化学需氧量）作为关键污染指标，传统化学检测法存在周期长、操作复杂、二次污染等缺陷。
- **技术优势**：光谱技术（紫外 + 荧光）具有快速、无损、无污染特点，结合机器学习可解决单一光谱模型精度低的问题。
- **研究目标**：建立基于多光谱数据融合与机器学习的水质COD定量检测模型，实现标准液与实际水样的高精度检测。

## 二、关键技术基础

### 1. 光谱技术原理
- **紫外光谱**：利用有机物分子电子跃迁（200-300nm 为主要吸收波段），通过吸光度反映COD浓度。
- **荧光光谱**：激发光（265nm/285nm）照射下有机物发射荧光（300-525nm），荧光强度与低浓度COD呈正相关（高浓度易出现荧光猝灭）。

### 2. 数据处理方法
- **预处理**：采用SG平滑（去噪）、基线校正（剔除背景干扰）、归一化（去量纲）。
- **特征选取**：
    - 连续投影算法（SPA，筛选低冗余特征波长）。
    - 竞争性自适应重加权算法（CARS，基于回归系数筛选关键特征）。

### 3. 机器学习算法
| 算法 | 核心特点 | 应用场景 |
| :--- | :--- | :--- |
| 随机森林（RF） | 抗过拟合、泛化能力强 | 标准液 / 实际水样建模 |
| 支持向量机（SVM） | 鲁棒性强、适用于小样本 | 标准液单一光谱模型 |
| 最小二乘支持向量机（LSSVM） | 拟合性能优、泛化能力强 | 数据融合模型核心算法 |
| 偏最小二乘回归（PLS） | 降低共线性影响 | 单一光谱模型对比基准 |

### 4. 数据融合技术
- **数据级融合（LLDF）**：直接拼接紫外与荧光光谱数据，保留完整信息但易过拟合。
- **特征级融合（MLDF）**：提取两种光谱特征构建新矩阵，降低冗余、提升模型效率。
- **决策级融合（HLDF）**：基于熵权TOPSIS或RF投票机制，融合特征级模型结果，进一步优化精度。

## 三、核心研究内容与结果

### 1. 标准液COD检测
- **实验设计**：配置 1-100mg/L 邻苯二甲酸氢钾标准液，采集紫外（200-500nm）与荧光（285nm激发）光谱数据。
- **单一光谱模型**：最优为 CARS-LSSVM，紫外光谱`R²=0.9735`（RMSE=1.6137mg/L），荧光光谱`R²=0.9723`（RMSE=1.4553mg/L）。
- **数据融合模型**：特征级融合（CARS-LSSVM-MLDF）效果最佳，`R²=99.9%`，RMSE=0.2971mg/L。

### 2. 浊度影响与补偿
- **问题**：浊度（NTU）会增强紫外光谱吸光度，导致COD预测值偏高。
- **补偿方案**：
    1. **方案一（优选）**：基于预测值与真实值偏差量建立线性模型，补偿后平均绝对误差 = 1.0466mg/L。
    2. **方案二**：利用546nm处浊度与吸光度线性关系，补偿特征波长吸光度，误差 = 1.1725mg/L。

### 3. 实际水样COD检测
- **样本来源**：南京秦淮河流域等15个地点，采集45份地表水样本（COD=3.2037-20.6749mg/L）。
- **模型性能**：
    - **单一光谱模型**：CARS特征选取优于SPA，荧光光谱`R²=0.968`（RMSE=1.2909mg/L）。
    - **特征级融合**：CARS-MLDF模型`R²=0.983`，RMSE=0.7886mg/L。
    - **决策级融合**：熵权TOPSIS-HLDF最优，`R²=0.9932`，RMSE=0.4582mg/L。

## 四、研究结论与展望

### 1. 核心结论
- **多光谱融合显著提升精度**：决策级融合模型较单一光谱模型RMSE降低64.5%，实现实际水样快速、无损、高精度检测。
- **关键技术组合**：CARS特征选取 + LSSVM算法 + 决策级融合为最优技术路径。
- **浊度补偿有效**：方案一操作简便、误差更小，适用于实际水体检测。

### 2. 未来展望
- **扩展样本覆盖**：增加高COD浓度污水样本，优化模型浓度适配范围。
- **完善环境干扰补偿**：研究温度、pH等其他环境因素的影响机制。
- **开发在线检测系统**：实现水质COD实时监测的工程化应用。

## 五、关键指标汇总
| 检测对象 | 模型类型 | 决定系数（`R²`） | 均方根误差（RMSE） |
| :--- | :--- | :--- | :--- |
| 标准液 | 特征级融合（CARS-LSSVM） | 99.9% | 0.2971mg/L |
| 标准液（浊度补偿） | 方案一 | - | 1.0466mg/L（平均绝对误差） |
| 实际水样 | 决策级融合（熵权TOPSIS） | 0.9932 | 0.4582mg/L |