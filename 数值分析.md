数值分析
1. 牛顿迭代法（解方程根） 本质是在求方程的根 **核心公式**： $$ x_{k+1} = x_k - \frac{f(x_k)}{f'(x_k)} $$ 示例：求 $\sqrt{115}$ 对应方程：$x^2 - 115 = 0$ 令 $f(x) = x^2 - 115$，则 $f'(x) = 2x$ 取初始值 $x_0 = 10.7$（估一个差不多的数） 计算过程： $$ x_1 = 10.7 - \frac{-0.51}{2 \times 10.7} = 10.723364 $$ $$ x_2 = 10.723805, \quad x_3 = 10.723805 \quad (\text{与} \ x_2 \ \text{的差小于} \ 10^{-6}) $$
2. 高斯消去法（解方程组） 待解方程组： $$ \begin{cases} x_1 + x_2 + x_3 = 6 \\ x_1 + 3x_2 - 2x_3 = 1 \\ 2x_1 - 2x_2 + x_3 = 1 \end{cases} $$消元过程： 
	1. 用方程② - ①，方程③ - ①×2，③ + ②×2： $$ \begin{cases} x_1 + x_2 + x_3 = 6 \\ 2x_2 - 3x_3 = -5 \\ -6x_3 = -18 \end{cases} $$ 
	2. 回代求解： $$ \begin{cases} x_1 = 1 \\ x_2 = 2 \\ x_3 = 3 \end{cases} $$
消去法的变种 
- **列主元消去**：第1列中数的绝对值最大的放在第一行 
- **全主元消去**：所有系数的绝对值最大的放在 $(1,1)$ 位置 以上例的全主元调整为例： 调整后方程组（将 $3x_2$ 移至首位）： $$ \begin{cases} 3x_2 + x_1 - 2x_3 = 1 \\ x_2 + x_1 + x_3 = 6 \\ -2x_2 + 2x_1 + x_3 = 1 \end{cases} $$ 再进行高斯消去

3. LU分解算法
核心：对于方程组 $Ax = b$，将 $A$ 分解成 $L$（下三角）· $U$（上三角）
$Ax = LUx = b$，令 $Ux = y$，则 $Ly = b$ 可求 $y$；$Ux = y$ 可求 $x$

示例：
$$
A = \begin{bmatrix} 2 & 1 & 1 \\ 4 & 3 & 3 \\ 8 & 7 & 9 \end{bmatrix} = \begin{bmatrix} 1 & 0 & 0 \\ 2 & 1 & 0 \\ 4 & 3 & 1 \end{bmatrix} \times \begin{bmatrix} 2 & 1 & 1 \\ 0 & 1 & 1 \\ 0 & 0 & 2 \end{bmatrix}
$$

规则：
- $U$ 的第一行和 $A$ 一样
- $L$ 的第一列是 $A$ 的第一列除以 $a_{11}$

4. 范数（不会，我赌不考）

5. 雅可比迭代法（大概概率不考，因为太麻烦）

对于方程组：
$$
\begin{cases}
10x_1 + 3x_2 + x_3 = 14 \\
2x_1 + 10x_2 + 3x_3 = 15 \\
x_1 + 3x_2 + 10x_3 = 16
\end{cases}
$$
步骤：
- 验证收敛
必须是严格对角占优矩阵（即 $|$ 主对角线元素 $| >$ 同行 $|$ 元素和 $|$）：
$|10| > |3| + |1| = 4$
$|-10| > |2| + |3| = 5$
$|10| > |1| + |3| = 4$
- 迭代公式 
  从原方程组整理得各变量的迭代形式： $$ \begin{cases} x_1 = \frac{1}{10}(14 - 3x_2 - x_3) \\ x_2 = \frac{1}{10}(5 + 2x_1 + 3x_3) \\ x_3 = \frac{1}{10}(14 - x_1 - 3x_2) \end{cases} $$ 计算过程 初始值可全取 $0$（不影响最终结果）：
		1. 代入 $(0, 0, 0)$，得 $x_1=1.4,\ x_2=0.5,\ x_3=1.4$； 
		2. 代入 $(1.4, 0.5, 1.4)$，得 $x_1=1.11,\ x_2=1.2,\ x_3=1.11$； 
		3. 代入 $(1.11, 1.2, 1.11)$，得 $x_1=0.929,\ x_2=1.055,\ x_3=0.929$； 
		停止条件：相邻两轮结果的差值小于 $10^{-3}$ 即可终止迭代。 
6. 拉格朗日插值
	1. 拉格朗日基函数： $$ L_i(x) = \prod_{\substack{j=0 \\ j \neq i}}^n \frac{x - x_j}{x_i - x_j} $$ 
	2. 插值多项式： $$ L_n(x) = \sum_{i=0}^n y_i L_i(x) $$ 
示例计算 已知插值节点： 

| $x_i$ | $-1$ | $1$ | $2$ |
|-------|------|-----|-----|
| $y_i$ | $-3$ | $0$ | $4$ |
		
计算各基函数： $$ L_0(x) = \frac{(x-1)(x-2)}{(-1-1)(-1-2)} = \frac{(x-1)(x-2)}{6} $$ $$ L_1(x) = \frac{(x+1)(x-2)}{(1+1)(1-2)} = \frac{(x+1)(x-2)}{2} $$ $$ L_2(x) = \frac{(x+1)(x-1)}{(2+1)(2-1)} = \frac{(x+1)(x-1)}{3} $$ 
构造插值多项式： $$ \begin{align*} L_2(x) &= -3 \cdot \frac{(x-1)(x-2)}{6} + 0 \cdot \frac{(x+1)(x-2)}{2} + 4 \cdot \frac{(x+1)(x-1)}{3} \\ &= \frac{5}{6}x^2 + \frac{3}{2}x - \frac{1}{3} \end{align*} $$

7. 牛顿插值
牛顿插值多项式的表达式为：
$$
P_n(x) = f[x_0] + f[x_0,x_1](x-x_0) + f[x_0,x_1,x_2](x-x_0)(x-x_1) + \dots
$$

差商定义
- 0阶差商：$f[x_i] = y_i$
- 1阶差商：$f[x_0,x_1] = \frac{f[x_1] - f[x_0]}{x_1 - x_0}$


示例计算
已知插值节点：$(0,1),\ (1,3),\ (2,9),\ (3,27)$，构造差商表：

| $x_i$ | $f[x_i]$ | 1阶差商 | 2阶差商 | 3阶差商 |
|-------|----------|---------|---------|---------|
| 0     | 1        | -       | -       | -       |
| 1     | 3        | $\frac{3-1}{1-0}=2$ | -       | -       |
| 2     | 9        | $\frac{9-3}{2-1}=6$ | $\frac{6-2}{2-0}=2$ | -       |
| 3     | 27       | $\frac{27-9}{3-2}=18$ | $\frac{18-6}{3-1}=6$ | $\frac{6-2}{3-0}=\frac{4}{3}$ |


最终牛顿插值多项式为：
$$
P_3(x) = 1 + 2x + 2x(x-1) + \frac{4}{3}x(x-1)(x-2)
$$


8. 插值余项
插值余项表示原函数与插值多项式的误差，公式为：
$$
R_n(x) = f(x) - P_n(x)
$$

若函数 $f(x)$ 是 $n+1$ 阶可导的，则余项形式为（以3阶为例）：
| $x_i$ | $-1$ | $1$ | $2$ |
|-------|------|-----|-----|
| $y_i$ | $-3$ | $0$ | $4$ |

$$
R_2(x) = \frac{f'''(\xi)}{3!}(x+1)(x-1)(x-2) \quad (\xi \text{ 介于插值节点之间})
$$

9. 最小二乘法拟合
二次多项式拟合
拟合模型为 $y = a_0 + a_1x + a_2x^2$，通过最小二乘法构造法方程组：
$$
\begin{cases}
n a_0 + \left(\sum x_i\right)a_1 + \left(\sum x_i^2\right)a_2 = \sum y_i \\
\left(\sum x_i\right)a_0 + \left(\sum x_i^2\right)a_1 + \left(\sum x_i^3\right)a_2 = \sum x_i y_i \\
\left(\sum x_i^2\right)a_0 + \left(\sum x_i^3\right)a_1 + \left(\sum x_i^4\right)a_2 = \sum x_i^2 y_i
\end{cases}
$$

代入数据 $x=[1,2,3,4,5]$,$y=[1,4,7,8,6]$，计算得：
$n=5$，$\sum x_i=15$，$\sum x_i^2=55$，$\sum x_i^3=225$，$\sum x_i^4=979$；
$\sum y_i=26$，$\sum x_i y_i=92$，$\sum x_i^2 y_i=358$。
将上述值代入法方程组即可求解 $a_0,a_1,a_2$。


经验直线拟合
拟合模型为 $y = a_0 + a_1x$，对 $a_0,a_1$ 求偏导并令其为0，得法方程组：
$$
\begin{cases}
n a_0 + \left(\sum x_i\right)a_1 = \sum y_i \\
\left(\sum x_i\right)a_0 + \left(\sum x_i^2\right)a_1 = \sum x_i y_i
\end{cases}
$$

代入数据 $x=[0,1,2,3,4,5]$、$y=[1,2,4,4.5,5,6]$，计算得：
$\sum x_i=15$，$\sum y_i=22.5$，$\sum x_i^2=55$，$\sum x_i y_i=73.5$，代入后法方程组为：
$$
\begin{cases}
6a_0 + 15a_1 = 22.5 \\
15a_0 + 55a_1 = 73.5
\end{cases}
$$


指数函数拟合（$y = Ae^{Bx}$）

对模型两边取对数，转化为线性模型 $\bar{y} = a_0 + a_1x$（其中 $\bar{y}=\ln y$，$a_0=\ln A$，$a_1=B$）。

代入数据 $x=[1,2,3,4]$,$y=[7,11,17,27]$，计算得：
$\sum x_i=10$，$\sum x_i^2=30$，$\sum \bar{y}=10.48$，$\sum x_i \bar{y}=28.44$，构造法方程组：
$$
\begin{cases}
4a_0 + 10a_1 = 10.48 \\
10a_0 + 30a_1 = 28.44
\end{cases}
$$

求解得 $a_0=1.5$、$a_1=0.45$，对应原模型参数 $A=e^{1.5}\approx4.48$、$B=0.45$，最终拟合式为：
$$
y = 4.48e^{0.45x}
$$

10. 数值积分公式构造
- 构造积分公式：$\int_0^{3h} f(x)dx = A_1f(h) + A_2f(2h)$，通过代入简单函数确定系数 $A_1,A_2$：
代入 $f(x)=1$：$\int_0^{3h} 1dx = 3h = A_1 + A_2$
代入 $f(x)=x$：$\int_0^{3h} xdx = \frac{9}{2}h^2 = A_1h + 2A_2h$

联立解得：$\begin{cases} A_1 = -\frac{3}{2}h \\ A_2 = \frac{9}{2}h \end{cases}$

验证（代入 $f(x)=x^2$）：
- 精确积分：$\int_0^{3h} x^2dx = 9h^3$
- 公式计算：$A_1h^2 + A_2(2h)^2 = \frac{33}{2}h^3 \neq 9h^3$

因此该公式的**代数精度为1**（仅对一次及以下多项式精确成立）。


11.  改进欧拉法（预测-校正法）原理
通过“预测（欧拉法）+ 校正（梯形法）”提高数值解精度，步骤为：
- **预测（欧拉法）**：$\bar{y}_{n+1} = y_n + h \cdot f(x_n, y_n)$
- **校正（梯形法）**：$y_{n+1} = y_n + \frac{h}{2}\left[f(x_n, y_n) + f(x_{n+1}, \bar{y}_{n+1})\right]$


示例：求解 $\begin{cases} y' = 2x + y + 2 \\ y(0) = 0 \end{cases}$（步长 $h=0.2$，求 $x=0.6$ 处的解）
已知 $x_0=0,\ y_0=0$，$f(x,y)=2x + y + 2$：

- **第一步（$x_1=0.2$）**：
  预测：$\bar{y}_1 = 0 + 0.2 \cdot (0+0+2) = 0.4$
  校正：$f(x_1, \bar{y}_1) = 2 \times 0.2 + 0.4 + 2 = 2.8$
  $y_1 = 0 + \frac{0.2}{2} \times (2 + 2.8) = 0.48$

- **第二步（$x_2=0.4$）**：
  预测：$\bar{y}_2 = 0.48 + 0.2 \cdot (0.4 + 0.48 + 2) = 1.056$
  校正：$f(x_2, \bar{y}_2) = 2 \times 0.4 + 1.056 + 2 = 3.856$
  $y_2 = 0.48 + 0.1 \times [3.856 + (0.8 + 0.48 + 2)] = 1.1536$

- **第三步（$x_3=0.6$）**：
  预测：$\bar{y}_3 = y_2 + 0.2 \cdot f(x_2,y_2) = 1.1536 + 0.2 \times 3.9536 = 1.94432$
  校正：$f(x_3,\bar{y}_3) = 2 \times 0.6 + 1.94432 + 2 = 5.14432$
  $$
   \begin{align*}
   y_3 &= y_2 + \frac{0.2}{2} \left[ f(x_2,y_2) + f(x_3,\bar{y}_3) \right] \\
   &= 1.1536 + 0.1 \times (3.9536 + 5.14432) \\
   &= 1.1536 + 0.909792 \\
   &= 2.063392 \approx 2.0634
   \end{align*}
   $$
最终，$x=0.6$ 处的数值解为 $y \approx 2.0634$。